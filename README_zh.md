# Outline Hexo Connector

ä¸€ä¸ªç”¨äºè‡ªåŠ¨åŒæ­¥ [Outline](https://www.getoutline.com/) æ–‡æ¡£åˆ° [Hexo](https://hexo.io/) åšå®¢çš„ Webhook å¤„ç†å™¨ã€‚

[English](README.md)

## ğŸ“ ç®€ä»‹

Outline Hexo Connector æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ Go æœåŠ¡ï¼Œç”¨äºç›‘å¬ Outline Wiki çš„ Webhook äº‹ä»¶ï¼Œå¹¶è‡ªåŠ¨å°†æ–‡æ¡£å†…å®¹åŒæ­¥åˆ° Hexo é™æ€åšå®¢ç³»ç»Ÿã€‚å½“ Outline ä¸­çš„æ–‡æ¡£å‘ç”Ÿå˜åŒ–æ—¶ï¼ˆå¦‚åˆ›å»ºã€å‘å¸ƒã€æ›´æ–°æˆ–åˆ é™¤ï¼‰ï¼Œæœ¬æœåŠ¡ä¼šè‡ªåŠ¨å¤„ç†è¿™äº›äº‹ä»¶å¹¶è§¦å‘ç›¸åº”çš„æ“ä½œã€‚

## âœ¨ ç‰¹æ€§

- ğŸ” **å®‰å…¨éªŒè¯**ï¼šæ”¯æŒ Outline Webhook ç­¾åéªŒè¯ï¼Œç¡®ä¿è¯·æ±‚æ¥æºçš„å¯é æ€§
- ğŸ“‹ **äº‹ä»¶å¤„ç†**ï¼šæ”¯æŒå¤šç§æ–‡æ¡£äº‹ä»¶ï¼ˆåˆ›å»ºã€å‘å¸ƒã€å–æ¶ˆå‘å¸ƒã€å½’æ¡£ã€åˆ é™¤ç­‰ï¼‰
- ğŸ§ª **æµ‹è¯•æ¨¡å¼**ï¼šå†…ç½®æµ‹è¯•æ¨¡å¼ï¼Œæ–¹ä¾¿è°ƒè¯• Webhook è¯·æ±‚
- âš™ï¸ **çµæ´»é…ç½®**ï¼šé€šè¿‡ YAML é…ç½®æ–‡ä»¶ç®¡ç†æ‰€æœ‰è®¾ç½®
- ğŸ” **é›†åˆè¿‡æ»¤**ï¼šå¯æŒ‡å®šç‰¹å®šçš„ Outline é›†åˆç”¨äºåšå®¢å‘å¸ƒ
- ğŸŒ **RESTful API**ï¼šä¸ Outline API å®Œæ•´é›†æˆ
- ğŸ¯ **é™„ä»¶å¤„ç†**ï¼šæ”¯æŒè·å–é™„ä»¶çš„é‡å®šå‘ URL

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Go 1.21 æˆ–æ›´é«˜ç‰ˆæœ¬
- è¿è¡Œä¸­çš„ Outline å®ä¾‹
- Hexo åšå®¢é¡¹ç›®ï¼ˆæµ‹è¯•æ—¶ä½¿ç”¨äº†fluidä¸»é¢˜ï¼‰

### å®‰è£…

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/Charles-IX/outline-hexo-connector.git
cd outline-hexo-connector

# å®‰è£…ä¾èµ–
go mod download

# æ„å»º
go build -o outline-hexo-connector
```

## âš™ï¸ é…ç½®

1. å¤åˆ¶é…ç½®ç¤ºä¾‹æ–‡ä»¶ï¼š

```bash
cp config_example.yaml config.yaml
```

2. ç¼–è¾‘ `config.yaml` å¹¶å¡«å†™ä½ çš„é…ç½®ä¿¡æ¯ï¼š

```yaml
# Outline API å¯†é’¥
Outline_API_Key: your_api_key_here

# Outline API åœ°å€
Outline_API_URL: https://outline.example.com/api

# Webhook å¯†é’¥ï¼ˆç”¨äºéªŒè¯è¯·æ±‚ç­¾åï¼‰
Outline_Webhook_Secret: your_webhook_secret_here

# ç”¨äºåšå®¢å‘å¸ƒçš„é›†åˆåç§°
Outline_Collection_Used_For_Blog: Blog

# Hexo æ„å»ºè§¦å‘é—´éš”ï¼ˆç§’ï¼‰ï¼Œé˜²æ­¢é¢‘ç¹è§¦å‘
Hexo_Build_Interval: 30

# Hexo æ„å»ºå‘½ä»¤
Hexo_Build_Command: hexo clean && hexo generate

# Hexo æ–‡ç« å­˜æ”¾ç›®å½•ï¼ˆç”¨äºå†™å…¥åŒæ­¥çš„ Markdown æ–‡ä»¶ï¼‰
Hexo_Source_Post_Dir: hexo/source/_posts
```

### é…ç½®è¯´æ˜

| é…ç½®é¡¹ | è¯´æ˜ | å¿…å¡« |
|-------|------|------|
| `Outline_API_Key` | Outline API è®¿é—®å¯†é’¥ | âœ… |
| `Outline_API_URL` | Outline API ç«¯ç‚¹åœ°å€ | âœ… |
| `Outline_Webhook_Secret` | Webhook ç­¾åéªŒè¯å¯†é’¥ | âœ… |
| `Outline_Collection_Used_For_Blog` | æŒ‡å®šç”¨äºåšå®¢çš„é›†åˆåç§° | âœ… |
| `Hexo_Build_Interval` | Hexo æ„å»ºè§¦å‘çš„æœ€å°é—´éš”æ—¶é—´ï¼ˆç§’ï¼‰ï¼Œç”¨äºé˜²æŠ– | âœ… |
| `Hexo_Build_Command` | æ‰§è¡Œ Hexo æ„å»ºçš„ Shell å‘½ä»¤ | âœ… |
| `Hexo_Source_Post_Dir` | Hexo åšå®¢çš„ `source/_posts` ç›®å½•è·¯å¾„ | âœ… |

### æ”¯æŒçš„äº‹ä»¶ç±»å‹

Connector ç›®å‰æ”¯æŒç›‘å¬å¹¶å¤„ç†ä»¥ä¸‹ Outline Webhook äº‹ä»¶ï¼š

- **å‘å¸ƒä¸æ›´æ–°äº‹ä»¶** (è§¦å‘æ–‡ç« åˆ›å»º/æ›´æ–° + Hexo æ„å»º):
    - `documents.publish`: æ–‡æ¡£å‘å¸ƒæ—¶
    - `documents.unarchive`: æ–‡æ¡£ä»å½’æ¡£æ¢å¤æ—¶
    - `documents.restore`: æ–‡æ¡£ä»å›æ”¶ç«™æ¢å¤æ—¶
    - `documents.move`: æ–‡æ¡£ç§»åŠ¨æ—¶ (æ›´æ–°åˆ†ç±»ä¿¡æ¯)
    - `documents.title_change`: æ–‡æ¡£æ ‡é¢˜å˜æ›´æ—¶
    - `documents.update`: æ–‡æ¡£å†…å®¹æ›´æ–°æ—¶

- **åˆ é™¤ä¸å½’æ¡£äº‹ä»¶** (è§¦å‘æ–‡ç« åˆ é™¤ + Hexo æ„å»º):
    - `documents.unpublish`: æ–‡æ¡£å–æ¶ˆå‘å¸ƒæ—¶
    - `documents.archive`: æ–‡æ¡£è¢«å½’æ¡£æ—¶
    - `documents.delete`: æ–‡æ¡£è¢«åˆ é™¤æ—¶

- **å…¶ä»–äº‹ä»¶**:
    - `documents.create`: ä»…åšå†…éƒ¨é€»è¾‘å¤„ç†ï¼Œé˜²æ­¢è‰ç¨¿è¢«æ„å¤–å‘å¸ƒ

## ğŸ“– ä½¿ç”¨æ–¹æ³•

### å¯åŠ¨æœåŠ¡

é»˜è®¤å¯åŠ¨ï¼ˆä½¿ç”¨ `config.yaml` é…ç½®æ–‡ä»¶ï¼Œç›‘å¬ 9000 ç«¯å£ï¼‰ï¼š

```bash
./outline-hexo-connector
```

### å‘½ä»¤è¡Œå‚æ•°

```bash
./outline-hexo-connector [OPTIONS]
```

**å¯ç”¨é€‰é¡¹ï¼š**

- `-p, --port <port>`ï¼šæŒ‡å®šç›‘å¬ç«¯å£ï¼ˆé»˜è®¤ï¼š9000ï¼‰
- `-c, --config <path>`ï¼šæŒ‡å®šé…ç½®æ–‡ä»¶è·¯å¾„ï¼ˆé»˜è®¤ï¼šconfig.yamlï¼‰
- `-t, --test`ï¼šå¯ç”¨æµ‹è¯•æ¨¡å¼ï¼Œä»…æ‰“å°æ¥æ”¶åˆ°çš„åŸå§‹è¯·æ±‚

### ç¤ºä¾‹

```bash
# ä½¿ç”¨è‡ªå®šä¹‰ç«¯å£
./outline-hexo-connector -p 8080

# ä½¿ç”¨è‡ªå®šä¹‰é…ç½®æ–‡ä»¶
./outline-hexo-connector -c /path/to/config.yaml

# å¯ç”¨æµ‹è¯•æ¨¡å¼
./outline-hexo-connector -t

# ç»„åˆä½¿ç”¨
./outline-hexo-connector -p 8080 -c custom.yaml
```

### é…ç½® Outline Webhook

1. ç™»å½•ä½ çš„ Outline ç®¡ç†é¢æ¿
2. è¿›å…¥ **åå¥½è®¾ç½®** â†’ **Webhooks**
3. åˆ›å»ºæ–°çš„ Webhookï¼š
   - **URL**: `http://Outline-Hexo-Connectorçš„IP:ç«¯å£/webhook`
   - **Secret**: å¤åˆ¶åˆ° `config.yaml` ä¸­çš„ `Outline_Webhook_Secret`
   - **Events**: é€‰æ‹©éœ€è¦ç›‘å¬çš„äº‹ä»¶ç±»å‹ï¼Œå»ºè®®åŒ…å« documents.create, documents.publish, documents.unpublish, documents.delete, documents.archive, documents.unarchive, documents.restore, documents.move, documents.update, documents.title_change
4. è¿›å…¥ **åå¥½è®¾ç½®** â†’ **API ä¸åº”ç”¨ç¨‹åº**
5. åˆ›å»ºæ–°çš„ API å¯†é’¥ï¼š
   - **ä½œç”¨åŸŸ**: è‡³å°‘éœ€è¦ documents.info, documents.unpublish, collections.info, attachments.redirect
   - **è¿‡æœŸæ—¶é—´**: æ ¹æ®è‡ªå·±éœ€æ±‚è€Œå®š
   - å°†åˆ›å»ºå¥½çš„ API å¯†é’¥å¤åˆ¶åˆ° `config.yaml` ä¸­çš„ `Outline_API_Key`

## âš ï¸ è¯´æ˜

ç”±äºOutlineä¼šè‡ªåŠ¨å‘å¸ƒåˆšåˆšåˆ›å»ºå¥½çš„æ–°æ–‡æ¡£ï¼Œä¸ºäº†é¿å…åœ¨Hexoä¸­æ–°å»ºä¸€ä¸ªæ— æ„ä¹‰çš„ç©ºæ–‡ä»¶å¹¶è§¦å‘æ„å»ºï¼Œæœ¬å·¥å…·ä¼šè‡ªåŠ¨å°†åˆšåˆ›å»ºå¥½çš„æ–‡æ¡£å–æ¶ˆå‘å¸ƒï¼Œå¾…ç¼–è¾‘å®Œæˆåå†æ¬¡å‘å¸ƒå³å¯ã€‚

æœ¬å·¥å…·ä¹Ÿä¼šè‡ªåŠ¨å°†ä½œç”¨èŒƒå›´å†…çš„æœ‰æ›´æ–°çš„æ–‡æ¡£å–æ¶ˆå‘å¸ƒï¼Œä»¥ä¾¿ç”¨æˆ·å¯ä»¥é€šè¿‡ç‚¹å‡»â€œå‘å¸ƒâ€æ¥æ„å»ºHexoåšå®¢ã€‚

## ğŸ·ï¸ æ–‡æ¡£è‡ªå®šä¹‰æ ‡ç­¾æŒ‡å—

ä¸ºäº†è®©åŒæ­¥åˆ° Hexo çš„æ–‡ç« å…·å¤‡å®Œæ•´çš„å…ƒæ•°æ®ï¼ˆå¦‚æ ‡ç­¾ã€æ‘˜è¦ã€å°é¢å›¾ï¼‰ï¼Œæœ¬å·¥å…·æ”¯æŒäº†ä¸€å¥—è‡ªå®šä¹‰çš„ Markdown è¯­æ³•æ ‡ç­¾ã€‚è¿™äº›æ ‡ç­¾åœ¨åŒæ­¥è¿‡ç¨‹ä¸­ä¼šè¢«è§£æå¤„ç†ï¼Œä¸ä¼šç›´æ¥æ˜¾ç¤ºåœ¨æ–‡ç« æ­£æ–‡ä¸­ã€‚

### 1. æ–‡ç« æ ‡ç­¾ (Tags)

ç”¨äºä¸º Hexo æ–‡ç« è®¾ç½®æ ‡ç­¾ã€‚æ”¯æŒä½¿ç”¨è‹±æ–‡é€—å· `,` æˆ–ä¸­æ–‡é€—å· `ï¼Œ` åˆ†éš”ã€‚

- **è¯­æ³•**ï¼š`+> Tags: tag1, tag2`
- **ä½ç½®**ï¼šå»ºè®®æ”¾åœ¨æ–‡æ¡£å¼€å¤´æˆ–ç»“å°¾ã€‚
- **æ•ˆæœ**ï¼šè§£æä¸º Front Matter ä¸­çš„ `tags: [tag1, tag2]`ï¼Œå¹¶ä»æ­£æ–‡ä¸­ç§»é™¤ã€‚

### 2. æ‘˜è¦åˆ†éš”ç¬¦ (Read More)

æ§åˆ¶æ–‡ç« åœ¨é¦–é¡µåˆ—è¡¨ä¸­çš„æ‘˜è¦æ˜¾ç¤ºèŒƒå›´ã€‚

- **è¯­æ³•**ï¼š`+> More:`
- **æ•ˆæœ**ï¼šæ›¿æ¢ä¸º Hexo çš„ `<!-- more -->` æ ‡è®°ã€‚åœ¨æ­¤æ ‡è®°ä¹‹å‰çš„å†…å®¹å°†ä½œä¸ºæ‘˜è¦æ˜¾ç¤ºã€‚

### 3.å°é¢ä¸ç¼©ç•¥å›¾ (Banner & Index Image)

è®¾ç½®æ–‡ç« çš„é¡¶éƒ¨å¤§å›¾ï¼ˆBannerï¼‰å’Œåˆ—è¡¨ç¼©ç•¥å›¾ï¼ˆIndex Imageï¼‰ã€‚è¯­æ³•ç±»ä¼¼äºæ ‡å‡†çš„ Markdown å›¾ç‰‡è¯­æ³•ï¼Œä½†ä½¿ç”¨ç‰¹å®šçš„ Alt æ–‡æœ¬ã€‚

| è¯­æ³• | è¯´æ˜ |
|------|------|
| `![banner_img](url)` | ä»…è®¾ç½®æ–‡ç« è¯¦æƒ…é¡µçš„é¡¶éƒ¨å°é¢å›¾ (Banner) |
| `![index_img](url)` | ä»…è®¾ç½®æ–‡ç« åˆ—è¡¨é¡µçš„ç¼©ç•¥å›¾ (Index) |
| `![banner_index_img](url)` | åŒæ—¶è®¾ç½® Banner å’Œ Index å›¾ç‰‡ |
| `![index_banner_img](url)` | åŒä¸Šï¼ŒåŒæ—¶è®¾ç½® Banner å’Œ Index å›¾ç‰‡ |

> **æ³¨æ„**ï¼šè¿™äº›ç‰¹æ®Šçš„å›¾ç‰‡æ ‡ç­¾åœ¨è§£æåä¼šä»æ­£æ–‡ä¸­ç§»é™¤ï¼Œè½¬åŒ–ä¸º Front Matter é…ç½®ã€‚

### ç¤ºä¾‹

åœ¨ Outline æ–‡æ¡£ä¸­ï¼š

```markdown
# æˆ‘çš„æ–°æ–‡ç« 

+> Tags: æŠ€æœ¯, Golang, æ•™ç¨‹

è¿™æ˜¯æ–‡ç« çš„æ‘˜è¦éƒ¨åˆ†ã€‚

+> More:

![banner_index_img](https://example.com/cover.jpg)

è¿™é‡Œæ˜¯æ–‡ç« çš„æ­£æ–‡å†…å®¹...
```

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
outline-hexo-connector/
â”œâ”€â”€ main.go                 # ä¸»ç¨‹åºå…¥å£ï¼Œå¤„ç†å‘½ä»¤è¡Œå‚æ•°å’Œä¿¡å·
â”œâ”€â”€ config_example.yaml     # é…ç½®ç¤ºä¾‹æ–‡ä»¶
â”œâ”€â”€ go.mod                  # Go æ¨¡å—å®šä¹‰
â”œâ”€â”€ README.md               # è‹±æ–‡æ–‡æ¡£
â”œâ”€â”€ README_zh.md            # ä¸­æ–‡æ–‡æ¡£
â””â”€â”€ internal/
    â”œâ”€â”€ config/
    â”‚   â””â”€â”€ config.go       # é…ç½®åŠ è½½ä¸è§£æ
    â”œâ”€â”€ hexo/
    â”‚   â”œâ”€â”€ renderer.go     # Hexo æ–‡ç« æ–‡ä»¶ç”Ÿæˆä¸å†™å…¥
    â”‚   â””â”€â”€ trigger.go      # Hexo æ„å»ºå‘½ä»¤è§¦å‘ä¸é˜²æŠ–æ§åˆ¶
    â”œâ”€â”€ outline/
    â”‚   â”œâ”€â”€ client.go       # Outline API å®¢æˆ·ç«¯ä¸ Webhook å¤„ç†
    â”‚   â””â”€â”€ models.go       # Outline æ•°æ®æ¨¡å‹å®šä¹‰
    â”œâ”€â”€ processor/
    â”‚   â”œâ”€â”€ converter.go    # é™„ä»¶ URL è½¬æ¢ä¸å¤„ç†
    â”‚   â””â”€â”€ parser.go       # Markdown å†…å®¹è§£æä¸å…ƒæ•°æ®æå–
    â””â”€â”€ test/
        â””â”€â”€ test.go         # æµ‹è¯•å·¥å…·ä¸ Debug è¾…åŠ©
```

## ğŸ› ï¸ å¼€å‘

### ä¾èµ–é¡¹

- [pflag](https://github.com/spf13/pflag) - å‘½ä»¤è¡Œå‚æ•°è§£æ
- [yaml.v3](https://gopkg.in/yaml.v3) - YAML é…ç½®æ–‡ä»¶è§£æ

### è¿è¡Œæµ‹è¯•æ¨¡å¼

æµ‹è¯•æ¨¡å¼å…è®¸ä½ æŸ¥çœ‹æ¥æ”¶åˆ°çš„åŸå§‹ Webhook è¯·æ±‚ï¼š

```bash
./outline-hexo-connector -t
```

ç„¶åä» Outline è§¦å‘ä¸€ä¸ªæµ‹è¯•äº‹ä»¶ï¼Œä½ å°†åœ¨æ§åˆ¶å°çœ‹åˆ°å®Œæ•´çš„è¯·æ±‚å†…å®¹ã€‚

## ğŸ“‹ å¾…åŠäº‹é¡¹

- [x] å®Œå–„ Hexo é€‚é…å™¨å®ç°
- [x] å®ç°æ–‡æ¡£åˆ° Markdown çš„å®Œæ•´è½¬æ¢
- [x] æ·»åŠ é™„ä»¶ URL è½¬æ¢åŠŸèƒ½ï¼ˆä»Outline APIè½¬åˆ°OSSæ°¸ä¹…é“¾æ¥ï¼‰
- [x] å®ç°æ–‡æ¡£å‘å¸ƒ/åˆ é™¤æ—¶çš„ Hexo æ„å»ºè§¦å‘
- [x] æ·»åŠ æ–‡æ¡£é˜Ÿåˆ—æœºåˆ¶ï¼Œæ”¯æŒå®šæœŸæ‰¹é‡æ„å»º
- [ ] æ·»åŠ å•å…ƒæµ‹è¯•
- [x] å®Œå–„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- [ ] æ”¯æŒæ•°æ®åº“å­˜å‚¨æ–‡æ¡£æ˜ å°„å…³ç³»ï¼ˆå­˜ç–‘ï¼‰
- [ ] æ·»åŠ  Docker æ”¯æŒ

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼
è¿™æ˜¯ä¸€ä¸ªæˆ‘å‡ºäºå®ç”¨æ€§è€ƒé‡å’Œç»ƒä¹ Goè€Œå†™çš„å°ç¨‹åºï¼Œè¯·å¤šæŒ‡æ•™ã€‚
~~ä¸è¿‡é¡¹ç›®åŸºæœ¬åŠŸèƒ½è¿˜æ²¡å®Œå…¨å®ç°ï¼ŒçœŸçš„ä¼šæœ‰äººäº¤ä¹ˆ~~
é¡¹ç›®åŸºæœ¬åŠŸèƒ½å·²ç»å®ç°ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€äº›é™åˆ¶ã€‚ä¹‹åå¯èƒ½ä¼šé€æ­¥å®Œå–„ã€‚

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ™ è‡´è°¢

- [Outline](https://www.getoutline.com/) - å¼ºå¤§çš„å›¢é˜ŸçŸ¥è¯†åº“
- [Hexo](https://hexo.io/) - å¿«é€Ÿã€ç®€æ´çš„åšå®¢æ¡†æ¶

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®,è¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- GitHub Issues: [https://github.com/Charles-IX/outline-hexo-connector/issues](https://github.com/Charles-IX/outline-hexo-connector/issues)

---
